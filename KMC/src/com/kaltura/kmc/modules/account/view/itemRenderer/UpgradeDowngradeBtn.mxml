<?xml version="1.0" encoding="utf-8"?>
<mx:HBox xmlns:mx="http://www.adobe.com/2006/mxml" 
	width="100%" height="100%" creationComplete="init()"
	horizontalScrollPolicy="off" verticalScrollPolicy="off"
	horizontalAlign="center" verticalAlign="middle">
	<mx:Script>
		<![CDATA[
			import com.kaltura.kmc.model.states.WindowsStates;
			import com.kaltura.kmc.events.ModalWindowEvent;
			import com.kaltura.kmc.vo.PackagesVO;
			import flash.utils.setTimeout;
			import com.kaltura.kmc.model.KMCModelLocator;
			private var _model : KMCModelLocator =  KMCModelLocator.getInstance();
			
			private var _currentState : String = "";

			private function init() : void
			{
				var currentPackage : PackagesVO;
				
				var foundIt : Boolean = false;
				for(var i:int=0; i< _model.listPackages.length ; i++)
				{
					if(_model.listPackages[i].pId == _model.partnerData.partnerPackage)
					{
						currentPackage = _model.listPackages[i];
						foundIt = true;
					}
				}
				
				if(!foundIt)
					return;
					
				if( data.pId == _model.partnerData.partnerPackage) 
				{
					btn.visible=true;
					currentState = "showText";
				}
				else if(data.cycleFee == 0)
				{
					btn.visible = false;
				}
				else if(data.cycleFee > currentPackage.cycleFee)
				{
					btn.visible=true;
					btn.label = resourceManager.getString('account', 'upgrade');
				}
				else if(data.cycleFee < currentPackage.cycleFee)
				{
					btn.visible=true;
					btn.label = resourceManager.getString('account', 'downgrade');
				}
				else
					btn.visible = false;
					
			} 
			
			private function btnClick() : void
			{
				var mwEvent : ModalWindowEvent = new ModalWindowEvent( ModalWindowEvent.OPEN_PAYPAL_WINDOW , 
																	   true , 
																	   WindowsStates.UPGRATE_TO_PACKAGE);
				mwEvent.data = data;
				mwEvent.dispatch();
			}	
		]]>
	</mx:Script>
	<mx:states>
		<mx:State name="showText">
			<mx:AddChild relativeTo="{btn}" position="before">
				<mx:Text width="100%"
					textAlign="center"
					text="{resourceManager.getString('account', 'yourPackage')}" />
			</mx:AddChild> 
			<mx:RemoveChild target="{btn}"  /> 
		</mx:State> 
	</mx:states>
	<mx:Button id="btn" buttonMode="true" visible="false"
		click="btnClick()"/>
	
</mx:HBox>
